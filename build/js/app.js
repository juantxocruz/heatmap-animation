(()=>{"use strict";var t,e={151:(t,e,n)=>{var i=n(243),a=n(974),r=n.n(a),o=[[0,"Sunday"],[1,"Monday"],[2,"Tuesday"],[3,"Wednesday"],[4,"Thursday"],[5,"Friday"],[6,"Saturday"]],s=[[0,"6AM",6],[1,"7AM",7],[2,"8AM",8],[3,"9AM",9],[4,"10AM",10],[5,"11AM",11],[6,"12PM",12],[7,"1PM",13],[8,"2PM",14],[9,"3PM",15],[10,"4PM",16],[11,"5PM",17],[12,"6PM",18],[13,"7PM",19],[14,"8PM",20],[15,"9PM",21],[16,"10PM",22],[17,"11PM",23],[18,"12AM",0],[19,"1AM",1],[20,"2AM",2],[21,"3AM",3],[22,"4AM",4],[23,"5AM",5]];function d(t){return t>=6&&t<=23?t-6:t+18}var l=function(){function t(t){this.obj=t,this.choices_days=o,this.choices_hours=s,this.currentFrame=0,this.heatmap=t.heatmap,this.data=t.data,this.interval=t.interval,this.animationSpeed=t.animationSpeed||500,this.wrapperEl=t.wrapperEl,this.playButton=t.playButton,this.isPlaying=t.isPlaying,this.dayTimeWindow=t.dayTimeWindow,this.stop(),this.init()}return t.prototype.init=function(){var t,e=this,n=this.data.length;this.wrapperEl.innerHTML="",this.playButton=this.playButton?this.playButton:document.createElement("button"),this.playButton.onclick=function(){e.isPlaying?e.stop():e.play(),e.isPlaying=!e.isPlaying},this.playButton.innerText="play",this.wrapperEl.appendChild(this.playButton);var i=document.createElement("div");i.className="heatmap-timeline",i.innerHTML='<div class="line"></div>';for(var a=0;a<this.data.length;a++){var r=100/(n-1)*a,o=document.createElement("div");o.className="time-point",o.style.left=r+"%",o.onclick=function(t){return function(){this.isPlaying=!1,this.stop(),this.setFrame(t)}.bind(this)}.bind(this)(a),i.appendChild(o)}this.wrapperEl.appendChild(i),t=this.dayTimeWindow.time_local_index>=this.dayTimeWindow.time_window_start_ix&&this.dayTimeWindow.time_local_index<=this.dayTimeWindow.time_window_end_ix?this.dayTimeWindow.time_local_index-this.dayTimeWindow.time_window_start_ix:this.dayTimeWindow.time_window_start_ix-this.dayTimeWindow.time_window_start_ix,this.setFrame(t)},t.prototype.play=function(){var t=this,e=this.data.length;this.playButton.innerText="pause",this.interval=setInterval((function(){t.setFrame(++t.currentFrame%e)}),this.animationSpeed)},t.prototype.stop=function(){clearInterval(this.interval),this.playButton&&(this.playButton.innerText="play")},t.prototype.setFrame=function(t){this.currentFrame=t;var e=this.data[t];this.heatmapData3={max:100,data:e},this.heatmap.setData(this.heatmapData3);for(var n=document.querySelectorAll(".heatmap-timeline .time-point"),i=0;i<n.length;i++)n[i].classList.remove("active"),n[i].innerHTML="";n[0].innerHTML='<div style="margin-top:12px; color:#a7a7a7;font-size:11px">'+this.dayTimeWindow.time_window_start_12h+"</div>",n[this.data.length-1].innerHTML='<div style="margin-top:12px;color:#a7a7a7;font-size:11px">'+this.dayTimeWindow.time_window_end_12h+"</div>",n[t].classList.add("active"),n[t].innerHTML='<div style="margin-top:12px; color:#7367F0;font-size:11px">'+this.choices_hours[t+this.dayTimeWindow.time_window_start_ix][1]},t.prototype.setAnimationData=function(t){this.isPlaying=!1,this.stop(),this.data=t,this.init()},t.prototype.setAnimationSpeed=function(t){this.isPlaying=!1,this.stop(),this.animationSpeed=t},t}();var u,h={radius:20,maxOpacity:.6,minOpacity:.3,blur:1,scaleRadius:!1,gradient:{"0.0":"green",.5:"orange",.8:"red"},useLocalExtrema:!1,latField:"lat",lngField:"lng",valueField:"count"};i.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'Map data &copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://cloudmade.com">CloudMade</a>',maxZoom:18});var c,p,m,y=i.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community"}),_=[40.423686379181405,-3.710858047841252],f=new i.LayerGroup,w=i.marker(_),v=[],g=function(t){return Number(t*Math.PI/180)};function M(t,e,n,i,a){void 0===n&&(n=1e3),void 0===i&&(i=!0),void 0===a&&(a=-1);var o,s=function(t,e){return e.map((function(e){return e.slice(t.time_window_start_ix,t.time_window_end_ix+1)}))}(t,e),d=b(t);e&&(u.hasLayer(f)&&f.clearLayers(),u.hasLayer(c)&&u.removeLayer(c),c=new(r())(h),o={max:100,data:s[d][0]},c.setData(o),c.addTo(u),u.on("moveend",(function(){m||(m=setTimeout((function(){(function(){u.getCenter().lat.toFixed(2),u.getCenter().lng.toFixed(2),u.getZoom();var t,e,n,i,a,r,o,s,d,l=u.getBounds(),h=l.getSouthWest().wrap(),c=l.getNorthEast().wrap();Math.round(1e3*(t=h.lat,e=h.lng,n=c.lat,i=c.lng,a=g(n-t),r=g(i-e),o=g(t),s=g(n),d=Math.sin(a/2)*Math.sin(a/2)+Math.sin(r/2)*Math.sin(r/2)*Math.cos(o)*Math.cos(s),2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))*6371))})(),m=void 0}),2e3))})),function(t,e){b(t),p=new l({heatmap:c,data:e,interval:100,animationSpeed:Number(E("animateDelay")),wrapperEl:document.querySelector(".timeline-wrapper"),playButton:null,isPlaying:!1,dayTimeWindow:t})}(t,s[d]))}function x(){var t={day:E("daySelector"),hours:{hourMin:E("hour_min"),hourMax:E("hour_max")}},e=t.day,n=t.hours;if(""!==n.hourMin&&""!==n.hourMax&&d(Number(t.hours.hourMax))<d(Number(t.hours.hourMin)))return alert("Error: The minimum hour is higher than the maximum hour."),!1;var i,a=function(t){var e=o.filter((function(e){return e[0]===Number(t)}));return e.length>0?e[0]:o[0]}(e),r=function(t){var e=6===Number(t)?0:Number(t)+1,n=o.filter((function(t){return t[0]===e}));return n.length>0?n[0]:o[o.length-1]}(e),l=(i=n.hourMin)?s.filter((function(t){return t[2]===Number(i)}))[0]:s[0],u=function(t){return t?s.filter((function(e){return e[2]===Number(t)}))[0]:s[s.length-1]}(n.hourMax);return{day_window:a[1]+" "+l[1]+" until "+r[1]+" "+u[1],day_window_end_int:r[0],day_window_end_txt:r[1],day_window_start_int:a[0],day_window_start_txt:a[1],time_local:7,time_local_12:"7AM",time_local_index:1,time_window_end:u[2],time_window_end_12h:u[1],time_window_end_ix:u[0],time_window_start:l[2],time_window_start_12h:l[1],time_window_start_ix:l[0]}}function T(t){p&&p.stop();var e=x(),n=Number(E("animateDelay"));M(e,v,n)}function b(t){return 0===t.day_window_start_int&&6===t.day_window_end_int?7:t.day_window_start_int}function E(t){var e=document.getElementById(t);return e.options[e.selectedIndex].value}var P=function(t){p&&p.stop();var e=x(),n=Number(E("animateDelay"));M(e,v,n)},S=function(t){p.setAnimationSpeed(parseInt(t.currentTarget.value))};function L(){var t,e,a,r,d,l,h,c=(a=(e=(t=window.location).href).substring(0,e.lastIndexOf("/")+1),{url:t,location:e,directoryPath:a});delete i.Icon.Default.prototype._getIconUrl,i.Icon.Default.mergeOptions({iconRetinaUrl:n(403),iconUrl:n(94),shadowUrl:n(965)}),u=i.map("map_leaflet",{fullscreenControl:!0,center:_,zoom:16,layers:[y,f],scrollWheelZoom:!1}),w.addTo(u),r=document.getElementById("daySelector"),d=document.getElementById("animateDelay"),l=document.getElementById("hour_min"),h=document.getElementById("hour_max"),r.addEventListener("change",P,!1),d.addEventListener("change",S,!1),l.addEventListener("change",T,!1),h.addEventListener("change",T,!1),function(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="json",n.onload=function(){var t=n.status;!function(t,e){if(null!==t)console.log("Something went wrong: "+t);else{v=function(t){var e=function(t){var e=[];return o.forEach((function(n,i){e.push([]),s.forEach((function(n,a){e[i].push([]),t.forEach((function(t,r){var o;e[i][a].push({lat:t.lat,lng:t.lng,count:(o=t.days[i],"object"!=typeof o?0:t.days[i][n[2]]?t.days[i][n[2]]:0)})}))}))})),e}(t.filter((function(t){if(t.geometry&&t.geometry.coordinates&&t.geometry.coordinates[0]&&t.geometry.coordinates[1]&&t.properties&&t.properties.goo&&t.properties.goo.popular_time&&t.properties.goo.popular_time.days)return!0})).map((function(t){return{lat:t.geometry.coordinates[1],lng:t.geometry.coordinates[0],days:t.properties.goo.popular_time.days}}))),n=function(t){var e=[];return t.forEach((function(n,i){n.forEach((function(n,a){0===i&&e.push([]),n.forEach((function(n,r){0===i?e[a].push({lat:t[i][a][r].lat,lng:t[i][a][r].lng,count:t[i][a][r].count}):e[a][r].count+=t[i][a][r].count}))}))})),e}(e);return e.push(n),e}(e);var n=x(),i=Number(E("animateDelay"))||500;M(n,v,i)}}(200===t?null:t,n.response)},n.send()}(c.directoryPath+"data/samples_popular_times.json")}window.onload=function(){L()}}},n={};function i(t){var a=n[t];if(void 0!==a)return a.exports;var r=n[t]={exports:{}};return e[t].call(r.exports,r,r.exports,i),r.exports}i.m=e,t=[],i.O=(e,n,a,r)=>{if(!n){var o=1/0;for(u=0;u<t.length;u++){for(var[n,a,r]=t[u],s=!0,d=0;d<n.length;d++)(!1&r||o>=r)&&Object.keys(i.O).every((t=>i.O[t](n[d])))?n.splice(d--,1):(s=!1,r<o&&(o=r));if(s){t.splice(u--,1);var l=a();void 0!==l&&(e=l)}}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[n,a,r]},i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.p="/pruebas/heatmap/build/",(()=>{var t={143:0};i.O.j=e=>0===t[e];var e=(e,n)=>{var a,r,[o,s,d]=n,l=0;if(o.some((e=>0!==t[e]))){for(a in s)i.o(s,a)&&(i.m[a]=s[a]);if(d)var u=d(i)}for(e&&e(n);l<o.length;l++)r=o[l],i.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return i.O(u)},n=self.webpackChunkwebpack_starter=self.webpackChunkwebpack_starter||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var a=i.O(void 0,[279],(()=>i(151)));a=i.O(a)})();
//# sourceMappingURL=app.js.map